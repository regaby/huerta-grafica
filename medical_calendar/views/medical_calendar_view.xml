<openerp>
	<data>

    <record model="ir.ui.view" id="view_calendar_event_calendar_inherit">
        <field name="name">Turno</field>
        <field name="model">calendar.event</field>
        <field name="priority" eval="2"/>
        <field name="arch" type="xml">
            <calendar string="Medical Calendar" color="state" date_start="start" date_stop="stop" mode="week" quick_add="False" event_open_popup="%(calendar.view_calendar_event_form_popup)s">
					
					<field name="patient" />
					<field name="doctor_id" />
				</calendar>
        </field>
    </record>

    <record model="ir.ui.view" id="view_calendar_holiday_calendar_inherit">
        <field name="name">Licencia</field>
        <field name="model">calendar.event</field>
        <field name="priority" eval="2"/>
        <field name="arch" type="xml">
            <calendar string="Holiday Calendar" color="doctor_id" date_start="start" date_stop="stop" mode="month" quick_add="False" event_open_popup="%(calendar.view_calendar_event_form_popup)s">
					<field name="doctor_id" />
				</calendar>
        </field>
    </record>

     <record model="ir.ui.view" id="view_calendar_event_form_inherit">
	        <field name="name">Calendar - Event Form</field>
	    	<field name="model">calendar.event</field>
	        <field name="inherit_id" ref="calendar.view_calendar_event_form" />
	        <field name="type">form</field>
	        <field name="arch" type="xml">
	        	<field name="categ_ids" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<field name="location" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>

	        	<field name="allday" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<label for="allday" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</label>

	        	<field name="class" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<field name="show_as" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<page string="Invitations" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</page>
	        	<page string="Misc" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</page>
	        	<xpath expr="//div[@class='oe_title']" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</xpath>
	        	<field name="start_datetime" position="attributes">
	        		<attribute name="required">True</attribute>
	        	</field>
	        	<field name="stop_datetime" position="attributes">
	        		<attribute name="required">True</attribute>
	        	</field>
	        	<xpath expr="//div[@class='oe_title']" position="after">
	        		<div class="oe_title" invisible="1">
	        			<field name="type" on_change="onchange_type(type)"/>
	        			<field name="state" invisible="0"/>
                    </div>
	        		<group name="medical_event" col="4">
	        			<button name="get_pami_link" string="Ver PadrÃ³n PAMI" type="object" attrs="{'invisible': [('type','!=','event')]}"/>
	        			<newline/>
						<field name="patient" context="{'default_is_patient':1, 'search_default_is_patient':1}" options="{'no_create': True}" attrs="{'required': [('type','=','event')],'invisible': [('type','!=','event')]}"/>
						<field name="doctor_id" options="{'no_create': True}"/>
						<field name="appointment_id" domain="[('patient','=',patient),('f_fecha_egreso','=',False)]" context="{'default_patient':patient, 'default_doctor':doctor_id}" on_change="onchange_appointment_id(appointment_id)" attrs="{'required': [('type','=','event')],'invisible': [('type','!=','event')]}"/>
						<field name="insurance_id" attrs="{'invisible': [('type','!=','event')]}" />
						<field name="practice_id" domain="[('frequently_used','=',True),('consultorio_externo','=',consultorio_externo)]" widget="selection" attrs="{'required': [('type','=','event')],'invisible': [('type','!=','event')]}"/>
						<field name="consultorio_externo" invisible="1"/>

						
					</group>
	        	</xpath>

			</field>
	    </record>

	   <record model="ir.ui.view" id="view_calendar_event_form_popup_inherit">
	        <field name="name">Calendar - Event Form</field>
	    	<field name="model">calendar.event</field>
	    	<field name="priority" eval="1"/>
	        <field name="inherit_id" ref="calendar.view_calendar_event_form_popup" />
	        <field name="type">form</field>
	        <field name="arch" type="xml">
	        	<field name="categ_ids" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<field name="location" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<field name="partner_ids" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<field name="name" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</field>
	        	<label for="name" position="attributes">
	        		<attribute name="invisible">True</attribute>
	        	</label>
	        	<field name="start_date" position="after">
	        		<field name="patient" />
	        		<field name="doctor_id" />
	        		<field name="insurance_id" />
	        		<field name="appointment_id" />
	        		<field name="practice_id" />
	        	</field>
	        	<field name="name" position="after">
	        		<header>
	        			<button string="Marcar Presente" type="object"
                                        name="action_present" states="draft" icon="terp-check" />
                        <button string="Marcar Ausente" type="object"
                                        name="action_absent" states="draft" icon="STOCK_CANCEL"/>
						<field name="state" widget="statusbar" nolabel="1" statusbar_visible="draft,done,declined"/>
	        		</header>
	        	</field>
			</field>
	    </record>

	<record model="ir.ui.view" id="view_calendar_event_search_inherit">
	        <field name="name">CRM - Meetings Search</field>
        	<field name="model">calendar.event</field>
	        <field name="inherit_id" ref="calendar.view_calendar_event_search" />
	        <field name="type">form</field>
	        <field name="arch" type="xml">
	        	<field name="name" position="replace">
	        		<field name="patient" />
					<field name="doctor_id" />
					<field name="state" />
					<field name="insurance_id" />
	        	</field>
	        	<field name="partner_ids" position="replace" />
                <field name="categ_ids" position="replace"/>
                <field name="user_id" position="replace"/>
                <field name="show_as" position="replace"/>
	        	
			</field>
	    </record>

	<record id="action_calendar_medical_event" model="ir.actions.act_window">
        <field name="name">Meetings</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_id" ref="view_calendar_event_calendar_inherit"/>
        <field name="search_view_id" ref="calendar.view_calendar_event_search"/>
        <field name="domain">[('type','=','event')]</field>
        <field name="context">{'default_type': 'event'}</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to schedule a new meeting.
          </p><p>
            The calendar is shared between employees and fully integrated with
            other applications such as the employee holidays or the business
            opportunities.
          </p>
        </field>
    </record>

    <record id="action_calendar_medical_holiday" model="ir.actions.act_window">
        <field name="name">Meetings</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_id" ref="view_calendar_holiday_calendar_inherit"/>
        <field name="search_view_id" ref="calendar.view_calendar_event_search"/>
        <field name="domain">[('type','=','holiday')]</field>
        <field name="context">{'default_type': 'holiday','default_state': 'holiday'}</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to schedule a new meeting.
          </p><p>
            The calendar is shared between employees and fully integrated with
            other applications such as the employee holidays or the business
            opportunities.
          </p>
        </field>
    </record>

		<menuitem name="Medical Calendar" id="medical_calendar_submenu" parent="medical.medical_root_menu" sequence="1" />
			<menuitem action="action_calendar_medical_event" id="medical_calendar_menu" parent="medical_calendar_submenu" sequence="1" name="Medical Calendar"/>
			<menuitem action="action_calendar_medical_holiday" id="medical_calendar_holiday_menu" parent="medical_calendar_submenu" sequence="2" name="Holiday Calendar"/>

	</data>
</openerp>